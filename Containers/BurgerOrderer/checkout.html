<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
</head>
<body>
    <h1>Your Order</h1>
    <div id="orderSummary"></div>
    <button id="confirmButton">Confirm Order</button>
    <button onclick="goBackToStart()">Go Back to Start</button>
    <script type="module" src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        // Retrieve the order saved in localStorage so we can use it now at checkout page.
        let order = JSON.parse(localStorage.getItem('currentOrder'));

        // Check if the order exists
        const orderSummaryDiv = document.getElementById('orderSummary');
        if (!order || order.length === 0) {
            orderSummaryDiv.textContent = 'No items in the order.';
        } else {
            // Display the items in the 'orderSummary' div
            order.forEach(item => {
                let orderItem = document.createElement('p');
                orderItem.textContent = item;
                orderSummaryDiv.appendChild(orderItem);
            });
        }

        // Function to send the order to backend for confirmation
        function confirmOrder() {
            axios.post('http://localhost:3000/checkout/confirm', { burgers: order })
                .then(response => {
                    console.log('Order confirmed:', response.data);
                    alert('Order sent to the kitchen');
                })
                .catch(error => {
                    console.error('Error confirming order:', error);
                });
        }

        // Add an event listener to the Confirm button to trigger the confirmOrder function
        document.getElementById('confirmButton').addEventListener('click', confirmOrder);

        // Function to take the user back to the homepage
        function goBackToStart() {
            window.location.href = '/';
        }
    </script>
</body>
</html>
