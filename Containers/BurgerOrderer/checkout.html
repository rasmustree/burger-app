<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <h1>Your Order</h1>
    <div id="orderSummary"></div>
    <button id="confirmButton">Confirm Order</button>
    <button onclick="goBackToStart()">Go Back to Start</button>
    <script type="module" src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        // Retrieve the order from localStorage
        let order = JSON.parse(localStorage.getItem('currentOrder')) || []; 
        let orderId = 0; // Initialize orderId

        // Display the order
        const orderSummaryDiv = document.getElementById('orderSummary');
        order.forEach(item => {
            let orderItem = document.createElement('p');
            orderItem.textContent = item;
            orderSummaryDiv.appendChild(orderItem);
        });

        // Function to confirm the order
        function confirmOrder() {
            orderId++; // Increment orderId for each order

            // Send order to backend
            axios.post('http://localhost:8078/order', { orderId, items: order }) // Ensure this matches your curl command
                .then(response => {
                    console.log('Order confirmed:', response.data);
                    alert('Order sent to the kitchen');
                })
                .catch(error => {
                    console.error('Error sending order:', error);
                    alert('There was an issue sending your order. Please try again.');
                });
        }

        // Add event listener to the Confirm button
        document.getElementById('confirmButton').addEventListener('click', confirmOrder);

        // Function to go back to the homepage
        function goBackToStart() {
            window.location.href = '/';
        }
    </script>
</body>
</html>
